}
C_uncertainty_small <- C_uncertainty_fraction * C_exp_small
C_uncertainty_large <- C_uncertainty_fraction * C_exp_large
# Generate random samples for C_exp
C_samples_small <- if (C_uncertainty_small > 0) {
rnorm(n_simulations, mean = C_exp_small, sd = C_uncertainty_small)
} else {
rep(C_exp_small, n_simulations)
}
C_samples_large <- if (C_uncertainty_large > 0) {
rnorm(n_simulations, mean = C_exp_large, sd = C_uncertainty_large)
} else {
rep(C_exp_large, n_simulations)
}
# Generate random samples for Vs using a uniform distribution
Vs_samples_small <- runif(n_simulations, min = Vs_low_small, max = Vs_high_small)
Vs_samples_large <- runif(n_simulations, min = Vs_low_large, max = Vs_high_large)
# Compute F_exp: F_exp = C_exp * Vs
F_exp_samples_small <- C_samples_small * Vs_samples_small
F_exp_samples_large <- C_samples_large * Vs_samples_large
# Total F_exp
F_exp_samples_total <- F_exp_samples_large + F_exp_samples_small
# Compute statistics
mean_F_exp <- mean(F_exp_samples_total)
std_F_exp <- sd(F_exp_samples_total)
# Compute Confidence Interval
z_value <- qnorm(1 - (1 - confidence_level) / 2)  # Z-score for confidence level
error_margin <- z_value * (std_F_exp / sqrt(n_simulations))
ci_lower <- mean_F_exp - error_margin
ci_upper <- mean_F_exp + error_margin
# Compute Percentiles (5th, 25th, 50th, 75th, 95th)
percentiles <- quantile(F_exp_samples_total, probs = c(0.05, 0.25, 0.5, 0.75, 0.95))
# Save results as a data frame
results <- data.frame(
F_exp_samples_total = F_exp_samples_total,
ci_lower = ci_lower,
ci_upper = ci_upper
)
# Print summary
cat(sprintf("\nEstimated F_exp: %.6f units\n", mean_F_exp))
cat(sprintf("Uncertainty (Standard Deviation): %.6f units\n", std_F_exp))
cat(sprintf("%.0f%% Confidence Interval: [%.6f, %.6f] units\n", confidence_level * 100, ci_lower, ci_upper))
cat("\nPercentiles:\n")
print(percentiles)
# Return results
return(results)
}
# Load required libraries
library(ggplot2)
library(readxl)
# Set seed for reproducibility
set.seed(123)
# Plankton data
C_exp_all <- read_xlsx("data_files_for_plotting/Cexp_for_MC_CALCULATIONS.xlsx")
# Define target group
print("SET TARGET GROUP")
#group <- 'foraminifera'
group <- 'gastropod'
# Extract data for small and large stages
C_exp_st6_large <- C_exp_all$Cexp[C_exp_all$station == 6 & C_exp_all$group == group & C_exp_all$stage == 'large']
C_exp_st9_large <- C_exp_all$Cexp[C_exp_all$station == 9 & C_exp_all$group == group & C_exp_all$stage == 'large']
C_exp_avg_large <- (C_exp_st6_large + C_exp_st9_large) / 2
C_exp_st6_small <- C_exp_all$Cexp[C_exp_all$station == 6 & C_exp_all$group == group & C_exp_all$stage == 'small']
C_exp_st9_small <- C_exp_all$Cexp[C_exp_all$station == 9 & C_exp_all$group == group & C_exp_all$stage == 'small']
C_exp_avg_small <- (C_exp_st6_small + C_exp_st9_small) / 2
C_exp_coccosphere <-  C_exp_all$Cexp[C_exp_all$station == 6 & C_exp_all$group == 'coccosphere' & C_exp_all$stage == 'sphere']
C_exp_cocco_single <- C_exp_all$Cexp[C_exp_all$station == 6 & C_exp_all$group == 'coccolith' & C_exp_all$stage == 'single']
C_exp_cocco_pellet <- C_exp_all$Cexp[C_exp_all$station == 6 & C_exp_all$group == 'coccolith' & C_exp_all$stage == 'pellet']
# Define Vs values for each category (Fixed values)
Vs_low_g_l <- 1000   # Large gastropod (min estimate)
Vs_high_g_l <- 1900  # Large gastropod (max estimate)
Vs_low_g_s <- 450    # Small gastropod (min estimate)
Vs_high_g_s <- 1000  # Small gastropod (max estimate)
Vs_low_f_l <- 100   # Large foraminifera (min estimate)
Vs_high_f_l <- 500  # Large foraminifera (max estimate)
Vs_low_f_s <- 10   # Small foraminifera (min estimate)
Vs_high_f_s <- 200  # Small foraminifera (max estimate)
Vs_low_c_single <- 0.5   # coccolith single (minimum estimate)
Vs_high_c_single <- 1.6 # coccolith single (maximum estimate)
Vs_low_c_pellet <- 50   # coccolith pellet,  (minimum estimate)
Vs_high_c_pellet <- 225  # coccolith pellet (maximum estimate)
Vs_low_c_sphere <- 2   # coccosphere (minimum estimate)
Vs_high_c_sphere <- 6  # coccosphere (maximum estimate)
if(group == 'gastropod'){
print('MC result gastropods')
# Run Monte Carlo Simulation for Gastropods
results_gastropods <- monte_carlo_F_exp(
C_exp_small = C_exp_avg_small,
C_exp_large = C_exp_avg_large,
C_uncertainty = 0.25,
Vs_low_small = Vs_low_g_s,
Vs_high_small = Vs_high_g_s,
Vs_low_large = Vs_low_g_l,
Vs_high_large = Vs_high_g_l,
n_simulations = 100000,
confidence_level = 0.95
)
write.csv(results_gastropods, "gastropods_F_exp_MC_results.csv", row.names = FALSE)
}
if(group == "foraminifera") {
print("MC result foraminifera: ")
# Run Monte Carlo Simulation for Forams
results_forams <- monte_carlo_F_exp(
C_exp_small = C_exp_avg_small,
C_exp_large = C_exp_avg_large,
C_uncertainty = 0.25,
Vs_low_small = Vs_low_f_s,
Vs_high_small = Vs_high_f_s,
Vs_low_large = Vs_low_f_l,
Vs_high_large = Vs_high_f_l,
n_simulations = 100000,
confidence_level = 0.95
)
write.csv(results_forams, "forams_F_exp_MC_results.csv", row.names = FALSE)
}
# Run Monte Carlo Simulation for Coccospheres
print("MC result coccospheres")
results_coccospheres <- monte_carlo_F_exp(
C_exp_small = C_exp_coccosphere,
C_exp_large = 0,  # for coccospheres, we do not discriminate between large and small
C_uncertainty = 0.25,
Vs_low_small = Vs_low_c_sphere,
Vs_high_small = Vs_high_c_sphere,
Vs_low_large = 0,
Vs_high_large = 0,
n_simulations = 100000,
confidence_level = 0.95
)
# Run Monte Carlo Simulation for Cocco_pellets
print("MC result coccos pellet")
results_cocco_pellet <- monte_carlo_F_exp(
C_exp_small = C_exp_cocco_pellet,
C_exp_large = 0, # for coccoliths pellets, we do not discriminate between large and small
C_uncertainty = 0.25,
Vs_low_small = Vs_low_c_pellet,
Vs_high_small = Vs_high_c_pellet,
Vs_low_large = 0,
Vs_high_large = 0,
n_simulations = 100000,
confidence_level = 0.95
)
# Run Monte Carlo Simulation for Cocco_single
print("MC result cocco single")
results_cocco_single <- monte_carlo_F_exp(
C_exp_small = C_exp_cocco_single,
C_exp_large = 0, # for coccoliths single, we do not discriminate between large and small
C_uncertainty = 0.25,
Vs_low_small = Vs_low_c_single,
Vs_high_small = Vs_high_c_single,
Vs_low_large = 0,
Vs_high_large = 0,
n_simulations = 100000,
confidence_level = 0.95
)
write.csv(results_coccospheres, "coccospheres_F_exp_MC_results.csv", row.names = FALSE)
write.csv(results_cocco_pellet, "cocco_pellet_F_exp_MC_results.csv", row.names = FALSE)
write.csv(results_cocco_single, "cocco_single_F_exp_MC_results.csv", row.names = FALSE)
knitr::opts_chunk$set(echo = TRUE)
# Load required library
library(ggplot2)
# Monte Carlo function that returns production samples & confidence intervals
monte_carlo_production <- function(ss_mean, ss_uncertainty_fraction, tt_low, tt_high, n_simulations = 100000, confidence_level = 0.95) {
# Set seed for reproducibility
set.seed(123)
ss_uncertainty <- ss_uncertainty_fraction * ss_mean
# Generate random samples for SS (Standing Stock)
ss_samples <- if (ss_uncertainty > 0) {
rnorm(n_simulations, mean = ss_mean, sd = ss_uncertainty)
} else {
rep(ss_mean, n_simulations)
}
# Generate random samples for TT (Turnover Time) - Uniform distribution
tt_samples <- runif(n_simulations, min = tt_low, max = tt_high)
# Compute Production: P = SS / TT
production_samples <- ss_samples / tt_samples
# Compute statistics
mean_production <- mean(production_samples)
std_production <- sd(production_samples)
# Compute Confidence Interval
z_value <- qnorm(1 - (1 - confidence_level) / 2)  # Z-score for given confidence level
error_margin <- z_value * (std_production / sqrt(n_simulations))
ci_lower <- mean_production - error_margin
ci_upper <- mean_production + error_margin
# Save results as a data frame
results <- data.frame(
production_samples = production_samples,
ci_lower = ci_lower,
ci_upper = ci_upper
)
# Print summary
cat(sprintf("Estimated Production: %.6f units\n", mean_production))
cat(sprintf("Uncertainty (Standard Deviation): %.6f units\n", std_production))
cat(sprintf("%.0f%% Confidence Interval: [%.6f, %.6f] units\n", confidence_level * 100, ci_lower, ci_upper))
# Return results
return(results)
}
# Load required libraries
library(ggplot2)
library(readxl)
# Set seed for reproducibility
set.seed(123)
# Plankton data
SS_all <- read_xlsx("data_files_for_plotting/Standingstocks_for_MC_CALCULATIONS.xlsx")
knitr::opts_chunk$set(echo = TRUE)
# Load required library
library(ggplot2)
# Monte Carlo function that returns production samples & confidence intervals
monte_carlo_production <- function(ss_mean, ss_uncertainty_fraction, tt_low, tt_high, n_simulations = 100000, confidence_level = 0.95) {
# Set seed for reproducibility
set.seed(123)
ss_uncertainty <- ss_uncertainty_fraction * ss_mean
# Generate random samples for SS (Standing Stock)
ss_samples <- if (ss_uncertainty > 0) {
rnorm(n_simulations, mean = ss_mean, sd = ss_uncertainty)
} else {
rep(ss_mean, n_simulations)
}
# Generate random samples for TT (Turnover Time) - Uniform distribution
tt_samples <- runif(n_simulations, min = tt_low, max = tt_high)
# Compute Production: P = SS / TT
production_samples <- ss_samples / tt_samples
# Compute statistics
mean_production <- mean(production_samples)
std_production <- sd(production_samples)
# Compute Confidence Interval
z_value <- qnorm(1 - (1 - confidence_level) / 2)  # Z-score for given confidence level
error_margin <- z_value * (std_production / sqrt(n_simulations))
ci_lower <- mean_production - error_margin
ci_upper <- mean_production + error_margin
# Save results as a data frame
results <- data.frame(
production_samples = production_samples,
ci_lower = ci_lower,
ci_upper = ci_upper
)
# Print summary
cat(sprintf("Estimated Production: %.6f units\n", mean_production))
cat(sprintf("Uncertainty (Standard Deviation): %.6f units\n", std_production))
cat(sprintf("%.0f%% Confidence Interval: [%.6f, %.6f] units\n", confidence_level * 100, ci_lower, ci_upper))
# Return results
return(results)
}
# Load required libraries
library(ggplot2)
library(readxl)
# Set seed for reproducibility
set.seed(123)
# Plankton data
SS_all <- read_xlsx("data_files_for_plotting/Standingstocks_for_MC_CALCULATIONS.xlsx")
knitr::opts_chunk$set(echo = TRUE)
# Load required library
library(ggplot2)
# Monte Carlo function that returns production samples & confidence intervals
monte_carlo_production <- function(ss_mean, ss_uncertainty_fraction, tt_low, tt_high, n_simulations = 100000, confidence_level = 0.95) {
# Set seed for reproducibility
set.seed(123)
ss_uncertainty <- ss_uncertainty_fraction * ss_mean
# Generate random samples for SS (Standing Stock)
ss_samples <- if (ss_uncertainty > 0) {
rnorm(n_simulations, mean = ss_mean, sd = ss_uncertainty)
} else {
rep(ss_mean, n_simulations)
}
# Generate random samples for TT (Turnover Time) - Uniform distribution
tt_samples <- runif(n_simulations, min = tt_low, max = tt_high)
# Compute Production: P = SS / TT
production_samples <- ss_samples / tt_samples
# Compute statistics
mean_production <- mean(production_samples)
std_production <- sd(production_samples)
# Compute Confidence Interval
z_value <- qnorm(1 - (1 - confidence_level) / 2)  # Z-score for given confidence level
error_margin <- z_value * (std_production / sqrt(n_simulations))
ci_lower <- mean_production - error_margin
ci_upper <- mean_production + error_margin
# Save results as a data frame
results <- data.frame(
production_samples = production_samples,
ci_lower = ci_lower,
ci_upper = ci_upper
)
# Print summary
cat(sprintf("Estimated Production: %.6f units\n", mean_production))
cat(sprintf("Uncertainty (Standard Deviation): %.6f units\n", std_production))
cat(sprintf("%.0f%% Confidence Interval: [%.6f, %.6f] units\n", confidence_level * 100, ci_lower, ci_upper))
# Return results
return(results)
}
# Load required libraries
library(ggplot2)
library(readxl)
# Set seed for reproducibility
set.seed(123)
# Plankton data
SS_all <- read_xlsx("data_files_for_plotting/Standingstocks_for_MC_CALCULATIONS.xlsx")
# extract data
SS_st6_gastro <- SS_all$`SSm2 [mg/m2]`[SS_all$station == 6 & SS_all$group == "gastropod total"]
SS_st9_gastro <- SS_all$`SSm2 [mg/m2]`[SS_all$station == 9 & SS_all$group == "gastropod total"]
SS_av_gastro <- (SS_st6_gastro + SS_st9_gastro )/2
SS_st6_foram <- SS_all$`SSm2 [mg/m2]`[SS_all$station == 6 & SS_all$group == "foraminifera total"]
SS_st9_foram <- SS_all$`SSm2 [mg/m2]`[SS_all$station == 9 & SS_all$group == "foraminifera total"]
SS_av_foram <- (SS_st6_foram + SS_st9_foram )/2
SS_st6_cocco <- SS_all$`SSm2 [mg/m2]`[SS_all$station == 6 & SS_all$group == "coccosphere"]
SS_st9_cocco <- SS_all$`SSm2 [mg/m2]`[SS_all$station == 9 & SS_all$group == "coccosphere"]
SS_av_cocco <- (SS_st6_cocco + SS_st9_cocco )/2
tt_low_g <- 5
tt_high_g <- 16
tt_low_f <- 14
tt_high_f <- 28
tt_low_c <- 0.6
tt_high_c <- 10
results_gastropods <- monte_carlo_production(SS_av_gastro, ss_uncertainty =  0.25, tt_low =  tt_low_g, tt_high = tt_high_g, n_simulations = 100000, confidence_level = 0.95 )
results_forams <- monte_carlo_production(SS_av_foram, ss_uncertainty =  0.25, tt_low =  tt_low_f, tt_high = tt_high_f, n_simulations = 100000, confidence_level = 0.95 )
results_cocco <- monte_carlo_production(SS_av_cocco, ss_uncertainty =  0.25, tt_low =  tt_low_c, tt_high = tt_high_c, n_simulations = 100000, confidence_level = 0.95 )
prod <- results_cocco$production_samples
ci_l <- results_cocco$ci_lower
ci_u <- results_cocco$ci_upper
# Plot histogram of production results with CI lines
p_cocco_ss <- ggplot(data.frame(prod), aes(x = prod)) +
geom_histogram(bins = 50, fill = "steelblue", alpha = 0.7, color = "black") +
geom_vline(xintercept = ci_l, color = "red", linetype = "dashed", linewidth = 0.01) +
geom_vline(xintercept = ci_u, color = "red", linetype = "dashed", linewidth = 0.01) +
labs(title = "Monte Carlo Simulation: Production distribution coccolithophores, tt 5-16 days",
x = "Production [mg/m2/day]", y = "Frequency") +
theme_minimal()
prod <- results_gastropods$production_samples
ci_l <- results_gastropods$ci_lower
ci_u <- results_gastropods$ci_upper
# Plot histogram of production results with CI lines
p_gastro_ss <- ggplot(data.frame(prod), aes(x = prod)) +
geom_histogram(bins = 50, fill = "steelblue", alpha = 0.7, color = "black") +
geom_vline(xintercept = ci_l, color = "red", linetype = "dashed", linewidth = 0.01) +
geom_vline(xintercept = ci_u, color = "red", linetype = "dashed", linewidth = 0.01) +
labs(title = "Monte Carlo Simulation: Production distribution gastropods, tt 0.6-10 days",
x = "Production [mg/m2/day]", y = "Frequency") +
theme_minimal()
prod <- results_forams$production_samples
ci_l <- results_forams$ci_lower
ci_u <- results_forams$ci_upper
# Plot histogram of production results with CI lines
p_foram_ss <- ggplot(data.frame(prod), aes(x = prod)) +
geom_histogram(bins = 50, fill = "steelblue", alpha = 0.7, color = "black") +
geom_vline(xintercept = ci_l, color = "red", linetype = "dashed", linewidth = 0.01) +
geom_vline(xintercept = ci_u, color = "red", linetype = "dashed", linewidth = 0.01) +
labs(title = "Monte Carlo Simulation: Production distribution Foraminifera, tt 14-28 days ",
x = "Production [mg/m2/day]", y = "Frequency") +
theme_minimal()
# save to pdf or png
ggsave("MC_SS_gastropod.png", p_gastro_ss, width = 8, height = 6, dpi = 300)
ggsave("MC_SS_foram.png", p_foram_ss, width = 8, height = 6, dpi = 300)
ggsave("MC_SS_coccosphere.png", p_cocco_ss, width = 8, height = 6, dpi = 300)
# Monte Carlo function for calculating F_exp
monte_carlo_TT <- function(SS_small, SS_large, C_exp_small, C_exp_large, C_uncertainty_fraction, SS_uncertainty_fraction, Vs_low_small, Vs_high_small, Vs_low_large, Vs_high_large, n_simulations = 100000, confidence_level = 0.95) {
# Ensure C_exp is valid
if (is.na(C_exp_small) || is.na(C_exp_large)) {
stop("Error: C_exp values contain NA. Please check input data.")
}
C_uncertainty_small <- C_uncertainty_fraction * C_exp_small
C_uncertainty_large <- C_uncertainty_fraction * C_exp_large
# Generate random samples for C_exp
C_samples_small <- if (C_uncertainty_small > 0) {
rnorm(n_simulations, mean = C_exp_small, sd = C_uncertainty_small)
} else {
rep(C_exp_small, n_simulations)
}
C_samples_large <- if (C_uncertainty_large > 0) {
rnorm(n_simulations, mean = C_exp_large, sd = C_uncertainty_large)
} else {
rep(C_exp_large, n_simulations)
}
SS_uncertainty_small <- SS_uncertainty_fraction * SS_small
SS_uncertainty_large <- SS_uncertainty_fraction * SS_large
# Generate random samples for SS (Standing Stock)
SS_samples_small <- if (SS_uncertainty_small > 0) {
rnorm(n_simulations, mean = SS_small, sd = SS_uncertainty_small)
} else {
rep(SS_small, n_simulations)
}
# Generate random samples for SS (Standing Stock)
SS_samples_large <- if (SS_uncertainty_large > 0) {
rnorm(n_simulations, mean = SS_large, sd = SS_uncertainty_large)
} else {
rep(SS_large, n_simulations)
}
# Generate random samples for Vs using a uniform distribution
Vs_samples_small <- runif(n_simulations, min = Vs_low_small, max = Vs_high_small)
Vs_samples_large <- runif(n_simulations, min = Vs_low_large, max = Vs_high_large)
# Compute F_exp: F_exp = C_exp * Vs
F_exp_samples_small <- C_samples_small * Vs_samples_small
F_exp_samples_large <- C_samples_large * Vs_samples_large
# Total F_exp
F_exp_samples_total <- F_exp_samples_large + F_exp_samples_small
# TT
TT_samples_small <- SS_samples_small / F_exp_samples_small
TT_samples_large <- SS_samples_large / F_exp_samples_large
# Compute statistics
mean_TT_small <- mean(TT_samples_small)
std_TT_small <- sd(TT_samples_small)
mean_TT_large <- mean(TT_samples_large)
std_TT_large <- sd(TT_samples_large)
# Compute Confidence Interval
z_value_s <- qnorm(1 - (1 - confidence_level) / 2)  # Z-score for confidence level
error_margin <- z_value_s * (std_TT_small / sqrt(n_simulations))
ci_lower_s <- mean_TT_small - error_margin
ci_upper_s <- mean_TT_small + error_margin
z_value_l <- qnorm(1 - (1 - confidence_level) / 2)  # Z-score for confidence level
error_margin <- z_value_l * (std_TT_large / sqrt(n_simulations))
ci_lower_l <- mean_TT_large - error_margin
ci_upper_l <- mean_TT_large + error_margin
# Compute Percentiles (5th, 25th, 50th, 75th, 95th)
percentiles_s <- quantile(TT_samples_small, probs = c(0.05, 0.25, 0.5, 0.75, 0.95))
percentiles_l <- quantile(TT_samples_large, probs = c(0.05, 0.25, 0.5, 0.75, 0.95))
# Save results as a data frame
results <- data.frame(
TT_samples_small = TT_samples_small,
mean_TT_small = mean_TT_small,
std_TT_small = std_TT_small,
ci_lower_s = ci_lower_s,
ci_upper_s = ci_upper_s,
TT_samples_large = TT_samples_large,
mean_TT_large = mean_TT_large,
std_TT_large = std_TT_large,
ci_lower_l = ci_lower_l,
ci_upper_l = ci_upper_l
)
#
# # Print summary
# cat(sprintf("\nEstimated F_exp: %.6f units\n", mean_TT_small))
# cat(sprintf("Uncertainty (Standard Deviation): %.6f units\n", std_TT_small))
# cat(sprintf("%.0f%% Confidence Interval: [%.6f, %.6f] units\n", confidence_level * 100, ci_lower, ci_upper))
# cat("\nPercentiles:\n")
# print(percentiles)
# Return results
return(results)
}
# Load required libraries
library(ggplot2)
library(readxl)
# Set seed for reproducibility
set.seed(123)
C_exp_all <- read_xlsx("data_files_for_plotting/Cexp_for_MC_CALCULATIONS.xlsx")
SS_all <- read_xlsx("data_files_for_plotting/Standingstocks_for_MC_CALCULATIONS.xlsx")
# Extract SS data
SS_st6_gastro_s <- SS_all$`SSm2 [mg/m2]`[SS_all$station == 6 & SS_all$group == "gastropod juvenile"]
SS_st9_gastro_s <- SS_all$`SSm2 [mg/m2]`[SS_all$station == 9 & SS_all$group == "gastropod juvenile"]
SS_av_gastro_s <- (SS_st6_gastro_s + SS_st9_gastro_s )/2
SS_st6_gastro_l <- SS_all$`SSm2 [mg/m2]`[SS_all$station == 6 & SS_all$group == "gastropod adult"]
SS_st9_gastro_l <- SS_all$`SSm2 [mg/m2]`[SS_all$station == 9 & SS_all$group == "gastropod adult"]
SS_av_gastro_l <- (SS_st6_gastro_l + SS_st9_gastro_l )/2
SS_st6_foram_s <- SS_all$`SSm2 [mg/m2]`[SS_all$station == 6 & SS_all$group == "foraminifera 100-200 um"]
SS_st9_foram_s <- SS_all$`SSm2 [mg/m2]`[SS_all$station == 9 & SS_all$group == "foraminifera 100-200 um"]
SS_av_foram_s <- (SS_st6_foram_s + SS_st9_foram_s )/2
SS_st6_foram_l <- SS_all$`SSm2 [mg/m2]`[SS_all$station == 6 & SS_all$group == "foraminifera > 200um"]
SS_st9_foram_l <- SS_all$`SSm2 [mg/m2]`[SS_all$station == 9 & SS_all$group == "foraminifera > 200um"]
SS_av_foram_l <- (SS_st6_foram_l + SS_st9_foram_l )/2
# Define target group
print("SET TARGET GROUP")
#group <- 'foraminifera'
group <- 'gastropod'
# Extract data for small and large stages
C_exp_st6_large <- C_exp_all$Cexp[C_exp_all$station == 6 & C_exp_all$group == group & C_exp_all$stage == 'large']
C_exp_st9_large <- C_exp_all$Cexp[C_exp_all$station == 9 & C_exp_all$group == group & C_exp_all$stage == 'large']
C_exp_avg_large <- (C_exp_st6_large + C_exp_st9_large) / 2
C_exp_st6_small <- C_exp_all$Cexp[C_exp_all$station == 6 & C_exp_all$group == group & C_exp_all$stage == 'small']
C_exp_st9_small <- C_exp_all$Cexp[C_exp_all$station == 9 & C_exp_all$group == group & C_exp_all$stage == 'small']
C_exp_avg_small <- (C_exp_st6_small + C_exp_st9_small) / 2
# Define Vs values for each category (Fixed values)
Vs_low_g_l <- 1000   # Large gastropod (min estimate)
Vs_high_g_l <- 1900  # Large gastropod (max estimate)
Vs_low_g_s <- 450    # Small gastropod (min estimate)
Vs_high_g_s <- 1000  # Small gastropod (max estimate)
Vs_low_f_l <- 100   # Large foraminifera (min estimate)
Vs_high_f_l <- 500  # Large foraminifera (max estimate)
Vs_low_f_s <- 10   # Small foraminifera (min estimate)
Vs_high_f_s <- 200  # Small foraminifera (max estimate)
if(group =="gastropod"){
# Run Monte Carlo Simulation for Gastropods
results_gastropods <- monte_carlo_TT(
SS_av_gastro_s,
SS_av_gastro_l,
C_exp_small = C_exp_avg_small,
C_exp_large = C_exp_avg_large,
C_uncertainty_fraction = 0.25,
SS_uncertainty_fraction = 0.25,
Vs_low_small = Vs_low_g_s,
Vs_high_small = Vs_high_g_s,
Vs_low_large = Vs_low_g_l,
Vs_high_large = Vs_high_g_l,
n_simulations = 100000,
confidence_level = 0.95
)
}
if(group =="foraminifera"){
# Run Monte Carlo Simulation for Forams
results_forams <- monte_carlo_TT(
SS_av_foram_s,
SS_av_foram_l,
C_exp_small = C_exp_avg_small,
C_exp_large = C_exp_avg_large,
C_uncertainty_fraction = 0.25,
SS_uncertainty_fraction = 0.25,
Vs_low_small = Vs_low_f_s,
Vs_high_small = Vs_high_f_s,
Vs_low_large = Vs_low_f_l,
Vs_high_large = Vs_high_f_l,
n_simulations = 100000,
confidence_level = 0.95
)
}
# Save results
#write.csv(results_gastropods, "gastropods_TT_MC_results.csv", row.names = FALSE)
#write.csv(results_forams, "forams_TT_MC_results.csv", row.names = FALSE)
